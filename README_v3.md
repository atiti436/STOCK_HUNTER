# 選股 BOT v3.2 使用說明

## 功能

找「法人剛進場、體質健康、還沒噴、營收成長」的股票（抓起漲點，不追高）

## 篩選條件

**基本面**
- 價格 30-300 元 (v3.2 放寬)
- PE < 35 (v3.2 放寬)
- ~~毛利率 > 20%~~ (暫時停用 - API 問題)
- ~~營業利益率 > 0%~~ (暫時停用 - API 問題)
- **營收 YoY > 0%** (v3.2 放寬)

**技術面**
- 今日漲幅 0-5%
- 近 5 日累積漲幅 < 10% (避免追高)
- 今日量 > 5 日均量 (啟動訊號)
- 股價 > MA20 (v3.2 新增)

**籌碼面**
- 法人買超 2-7 天 (v3.2 放寬)
- 法人 5 日累積 > 300 張 (v3.2 新增)
- 日成交量 > 800 張 (v3.2 新增)
- 法人 1 月累積 > -10,000 張 (避免長期賣壓)
- 主力分析 (投信/外資/混合)

## 使用方式

```bash
cd STOCK_HUNTER
python scan_v3.py
```

執行後會產生 `scan_result_v3.txt`，包含健康檢查報告和推薦股票。

## ⚠️ 防呆機制 (v3.2 新增)

### 健康檢查報告

輸出檔案會包含資料健康狀態：

```
[健康檢查]
✅ 資料正常
  證交所: 91 檔
  PE: 807 檔
  法人: 30/30 成功
  營收: 28/30 成功
```

### API 異常警告

當 API 有問題時會顯示警告：

| 異常類型 | 警告訊息 |
|---------|---------|
| API 完全失敗 | `API錯誤: xxx` |
| 達到 FinMind 上限 | `法人資料大量失敗 (xx%)，FinMind 可能達上限` |
| 資料被截斷 | `證交所 API 無資料（可能被擋或假日）` |
| 成功率過低 | `法人資料成功率過低 (xx%)` |

### LINE 訊息範例（有異常時）

```
📊 選股 BOT v3.2 - 2026-01-01

⚠️ 資料警告: 法人資料大量失敗 (45%)，FinMind 可能達上限

❌ 今日無符合條件的股票
```

## 環境設定

### FinMind API Token

程式已內建 Token（600 次/小時），也可透過環境變數覆蓋：

```bash
export FINMIND_TOKEN="your_token_here"
```

---

## 版本紀錄

### v3.2 (2026-01-01)
- **新增**: FinMind API Token 支援（600 次/小時）
- **新增**: 健康檢查報告（證交所/PE/法人/營收 成功率）
- **新增**: API 錯誤偵測與警告（達上限、被擋、無資料）
- **新增**: LINE 訊息顯示資料警告
- **新增**: 股價 > MA20 趨勢確認
- **新增**: 法人 5 日累積 > 300 張
- **新增**: 日成交量 > 800 張
- **放寬**: 價格 30-300 元（原 50-200）
- **放寬**: PE < 35（原 < 25）
- **放寬**: 營收 YoY > 0%（原 > 10%）
- **放寬**: 法人買超 2-7 天（原 3-5 天）

### v3.1 (2025-12-31)
- 新增: 營收 YoY > 10% 檢查
- 新增: 法人 1 月累積 > -10,000 張檢查
- 新增: 主力分析功能
- 移除: 寬鬆版輸出
- 暫停: 財報檢查

### v3.0 (2025-12-31)
- 新增：近 5 日漲幅檢查
- 新增：法人買超天數檢查
- 新增：成交量突破檢查

