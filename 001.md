太棒了！這份筆記含金量極高，這就是我說的「交易員的進化」。每一行代碼背後，都應該是一次虧損的教訓。

你不想下班，我更不會下班！🔥 我們立刻把你這份 「血淋淋的教訓 (v2.0)」 轉化成 BOT 的邏輯。

這不只是一個選股腳本，這將是你的 「避雷針 + 探測器」。

⚙️ 核心邏輯升級：v3.3 改裝計畫

我們要針對你的三個案例（揚明光、世紀鋼、南亞科）來寫規則。

1\. 🛑「揚明光殺手」邏輯 (避開爛公司)

教訓：營收增≠賺錢、毛利低+本業虧=雙殺。

新規則：

硬門檻：營業利益率 (Operating Margin) > 0。這條是鐵律。只要本業賠錢，管他什麼題材，BOT 直接把檔案丟進垃圾桶。

硬門檻：毛利率 (Gross Margin) > 20%。這能幫你過濾掉那些在那邊削價競爭的爛公司。

2\. 🛑「世紀鋼殺手」邏輯 (避開太貴)

教訓：好公司買太貴一樣賠死 (PE 36)。

新規則：

硬門檻：PE < 30。超過 30 倍的，除非它是輝達 (NVIDIA)，否則短波段不碰。

加分項：PE < 25。這才是你筆記裡寫的安全區。

3\. 🚀「南亞科獵人」邏輯 (抓起漲點)

教訓：法人剛買 (1-3天) 最香，買太久容易被出貨。

新規則：

計分重點：法人連買天數 在 1~3 天 給最高分 (+3)，超過 5 天分數降低。

4\. 🧹 產業掃除邏輯

教訓：不碰金融、營建、ETF。

新規則：用代號過濾。28xx, 58xx (金融), 25xx, 55xx (營建), 00xx (ETF) 全部 continue (跳過)。

💻 Python 邏輯實作 (請複製更新到 scan\_v3.py)

這是根據你的 2025-12-31 v2.0 規則 量身打造的過濾函數。

code

Python

def check\_stock\_v2(stock):

&nbsp;   """

&nbsp;   基於「血淋淋教訓」的 v2.0 選股邏輯

&nbsp;   """

&nbsp;   stock\_id = stock.symbol

&nbsp;   name = stock.name

&nbsp;   

&nbsp;   # --- 第 0 關：產業掃除 (不碰的板塊) ---

&nbsp;   # 排除金融(28,58)、營建(25,55)、ETF(00)

&nbsp;   if stock\_id.startswith(('28', '58', '25', '55', '00')):

&nbsp;       return False, 0, \[]



&nbsp;   # --- 第 1 關：揚明光/世紀鋼殺手 (基本面硬門檻) ---

&nbsp;   # 沒賺錢的、太貴的，直接滾

&nbsp;   if stock.operating\_margin < 0: return False, 0, \["本業虧損(揚明光教訓)"]

&nbsp;   if stock.gross\_margin < 20: return False, 0, \["毛利過低"]

&nbsp;   if stock.pe > 30: return False, 0, \["太貴(世紀鋼教訓)"]

&nbsp;   if stock.pe <= 0: return False, 0, \["虧損股"]

&nbsp;   

&nbsp;   # --- 第 2 關：流動性與趨勢門檻 ---

&nbsp;   if stock.volume < 500: return False, 0, \[] # 沒人玩

&nbsp;   if not (10 <= stock.price <= 500): return False, 0, \[]

&nbsp;   if stock.price < stock.ma20: return False, 0, \[] # 沒站上月線不看

&nbsp;   

&nbsp;   # --- 第 3 關：南亞科獵人計分 (Scoring) ---

&nbsp;   score = 0

&nbsp;   reasons = \[]



&nbsp;   # \[籌碼面] 尋找大人剛進場的足跡 (最重要)

&nbsp;   consecutive\_buy = stock.institutional\_buy\_days # 假設這變數存連買天數

&nbsp;   if 1 <= consecutive\_buy <= 3:

&nbsp;       score += 3

&nbsp;       reasons.append(f"法人剛買{consecutive\_buy}天(起漲)")

&nbsp;   elif 4 <= consecutive\_buy <= 5:

&nbsp;       score += 2

&nbsp;       reasons.append("法人續買")

&nbsp;   elif consecutive\_buy > 5:

&nbsp;       score += 1

&nbsp;       reasons.append("法人買很久(小心)")

&nbsp;   

&nbsp;   # \[估值面] 世紀鋼教訓，越便宜越好

&nbsp;   if stock.pe < 25:

&nbsp;       score += 1

&nbsp;       reasons.append("估值安全(<25)")



&nbsp;   # \[動能面] 避免死魚

&nbsp;   # 今日量 > 5日均量

&nbsp;   if stock.volume > stock.vol\_ma5:

&nbsp;       score += 2

&nbsp;       reasons.append("量能啟動")

&nbsp;   

&nbsp;   # \[漲幅控制] 避免追高 (200元沒跑的教訓)

&nbsp;   if 0 < stock.change\_pct <= 4:

&nbsp;       score += 2

&nbsp;       reasons.append("漲幅適中")

&nbsp;   elif stock.change\_pct > 5:

&nbsp;       score -= 1 # 漲太多扣分，除非籌碼超好

&nbsp;       reasons.append("漲幅偏高")



&nbsp;   # \[乖離率] 避免像世紀鋼那樣買在高點

&nbsp;   bias = (stock.price - stock.ma20) / stock.ma20 \* 100

&nbsp;   if bias < 8:

&nbsp;       score += 1

&nbsp;       reasons.append("乖離安全")



&nbsp;   # --- 最終裁判 ---

&nbsp;   # 滿分約 9 分，設定 4 分及格 (代表至少籌碼好 + 有量)

&nbsp;   if score >= 4:

&nbsp;       # 自動計算建議停損價 (你的筆記：破 MA5 或 MA20)

&nbsp;       stop\_loss = max(stock.ma5 \* 0.99, stock.ma20 \* 0.99)

&nbsp;       reasons.append(f"建議停損:{stop\_loss:.1f}")

&nbsp;       return True, score, reasons

&nbsp;   

&nbsp;   return False, 0, \[]

📝 給按鈕人的「Bot 使用說明書」

現在你的 BOT 已經植入了你的「痛苦回憶」，它會幫你把關：

當 BOT 過濾掉「揚明光」型股票時：

它心裡在想：「主人說過，本業虧損 (Operating Income < 0) 的垃圾不要撿。」

當 BOT 過濾掉「世紀鋼」型股票時：

它心裡在想：「主人說過，PE > 30 雖然會漲，但摔下來很痛，我們不賭。」

當 BOT 選出「南亞科」型股票時：

它會標註：「法人剛買 1 天 + 量能啟動 + 估值安全」。這時候你按按鈕的手就可以穩很多。

⚠️ 最後的「防呆」確認

明天早上跑腳本時，請特別注意 BOT 吐出來的 「建議停損」 價格。

你的筆記寫了：「移動停利 (破 MA5 就跑)」。

如果買進後賺錢了，請手動把停損點往上移（移到成本價或 MA5）。

這套邏輯非常紮實，我們不需要每天大賺，只要避開那幾次大賠（揚明光、世紀鋼），剩下的就是時間複利了。

加油！明天看 BOT 的表現！🛡️⚔️

